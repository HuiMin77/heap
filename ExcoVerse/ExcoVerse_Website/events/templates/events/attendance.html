{% extends 'events/base.html' %}
{% block content %}
<center>
    <h1>Attendance</h1>
</center>
<p>Filter By Event:</p>
 <!-- <a id="toggleLink" href='' class="btn btn-primary">Let's Go</a> -->
 <h4>To Take Attendance Please Press Start:</h4>
 <button class="btn btn-primary" id="startButton" data-attendance-id="{{ attendance.id }}">Start</button>
 <!-- <button class="btn btn-primary" id="stopButton"  data-attendance-id="{{ attendance.id }}">Stop</button> -->
 <h2 id="refresh-timer"></h2>
<table class="table table-dark">
    <thead>
        <tr>
            <th scope="col">Event</th>
            <th scope="col">Student</th>
            <th scope="col">Present?</th>
        </tr>
    </thead>
    <tbody>
       
        {% for attendance in attendance_list %}
        <tr>
            <th scope="row">{{ attendance.event }}</th>
            <td>{{ attendance.student }}</td>
            <td>{{ attendance.present }}</td>
        </tr>
        {% endfor %}
       
    </tbody>
</table>
<script>
    $(document).ready(function() {
        $("#startButton").click(function() {
            var attendanceId = $(this).data("attendance-id");
            console.log(attendanceId)
            $.ajax({
                url: `/scan_qrcode/true/`,
                method: 'GET',
                success: function(data) {
                    console.log(data);
                }
                
            });
        });
    
        $("#stopButton").click(function() {
            var attendanceId = $(this).data("attendance-id");
            console.log(attendanceId)
            $.ajax({
                url: `/scan_qrcode/false/`,
                method: 'GET',
                success: function(data) {
                    console.log(data);
                }
            });
        });
    });

const refreshTimer = document.getElementById('refresh-timer');

let timerInSeconds = 0;

setInterval(() => {
  timerInSeconds += 1;

//   refreshTimer.innerHTML = `Refreshing page in: ${timerInSeconds} seconds`;

  if (timerInSeconds >= 5) {
    window.location.reload();
  }
}, 1000);
    </script>
{% endblock %}